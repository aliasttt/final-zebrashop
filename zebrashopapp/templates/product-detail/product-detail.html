<!DOCTYPE html>
{% extends "partitions/base.html" %}

{% block head %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* استایل برای حالت موبایل */
        @media (max-width: 768px) {
            .product-info {
                margin-top: 20px;
                text-align: center;
            }
        }

        /* استایل برای عکس و دکمه‌ها */
        .product-image {
            max-width: 100%;
            height: auto;
            margin-bottom: 10px;
        }

        .image-container {
            position: relative;
        }

        .next-image-btn {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }

        .prev-image-btn {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
{% endblock head %}

{% block title %}
    {{ product.name }} - جزئیات محصول
{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <!-- سمت چپ: اطلاعات محصول -->
        <div class="col-lg-6 product-info">
            <h2>{{ product.name }}</h2>
            <p>{{ product.descriptions }}</p>

            <h4>انتخاب سایز:</h4>
            <form action="{% url 'zebrashopapp:add_to_basket' product.id %}" method="POST">
                {% csrf_token %}
                <select name="size" id="size" class="form-select">
                    {% for size in product.sizes.all %}
                        <option value="{{ size.id }}">{{ size.size }} </option>
                    {% endfor %}
                </select>
                <button type="submit" class="btn btn-primary mt-3">افزودن به سبد خرید</button>
            </form>

            <h4 class="mt-3">قیمت: {{ product.price }} تومان</h4>
        </div>

        <!-- سمت راست: نمایش تصویر محصول -->
        <div class="col-lg-6">
            <div class="image-container">
                {% for image in product.images.all %}
                    <img src="{{ image.image.url }}" class="d-block w-100 product-image" alt="{{ product.name }}">
                {% endfor %}

                <!-- دکمه بعدی و قبلی -->
                <button class="prev-image-btn">&#10094;</button>
                <button class="next-image-btn">&#10095;</button>
            </div>
        </div>
    </div>
</div>

<!-- جاوااسکریپت برای جابه‌جایی عکس‌ها -->
<script>
    let currentImageIndex = 0;
    const images = document.querySelectorAll('.image-container img');
    const prevButton = document.querySelector('.prev-image-btn');
    const nextButton = document.querySelector('.next-image-btn');

    function showImage(index) {
        images.forEach((img, i) => {
            img.style.display = (i === index) ? 'block' : 'none';
        });
    }

    prevButton.addEventListener('click', () => {
        currentImageIndex = (currentImageIndex > 0) ? currentImageIndex - 1 : images.length - 1;
        showImage(currentImageIndex);
    });

    nextButton.addEventListener('click', () => {
        currentImageIndex = (currentImageIndex < images.length - 1) ? currentImageIndex + 1 : 0;
        showImage(currentImageIndex);
    });

    // نمایش عکس اول به صورت پیش‌فرض
    showImage(currentImageIndex);
</script>
{% endblock content %}